/*
	2025-03-05 v0.1 Irfan
*/

DECLARE @ExtractDate DATETIME
SET @ExtractDate = GETDATE();

SELECT
	Transaction_Serial_No AS 'Transaction_Serial_No',
    Transaction_Datetime AS 'Transaction_Datetime',
    Random_No AS 'Random_No',
    HashBytes('SHA2_256', CustomerName) AS 'CustomerName',
    CustomerAge AS 'CustomerAge',
    HashBytes('SHA2_256', CustomerMobilePhone) AS 'CustomerMobilePhone',
    HashBytes('SHA2_256', AccountNo) AS 'AccountNo',
    BranchName AS 'BranchName',
    AccountOpeningDate AS 'AccountOpeningDate',
    CostCenter AS 'CostCenter',
    AccountStatus AS 'AccountStatus',
    ProductCode AS 'ProductCode',
    CustomerAvgIncome AS 'CustomerAvgIncome',
    CardStatus AS 'CardStatus',
    CardOpeningDate AS 'CardOpeningDate',
    Balance AS 'Balance',
    AgeOfOpenAcctTxn AS 'AgeOfOpenAcctTxn',
    AgeOfActiveCardTxn AS 'AgeOfActiveCardTxn',
    AgeOfOpenAcctActiveCard AS 'AgeOfOpenAcctActiveCard',
    TrfToBDIStaff AS 'TrfToBDIStaff',
    BDIStaff AS 'BDIStaff',
    AccountOpenYear AS 'AccountOpenYear',
    AgeOfRegDateTxn AS 'AgeOfRegDateTxn',
    RegDateEChannel AS 'RegDateEChannel',
    DistNo AS 'DistNo',
    SDBPastDueDate AS 'SDBPastDueDate',
    BoxTypeSize AS 'BoxTypeSize',
    BoxAmount AS 'BoxAmount',
    IsSDBPastDue AS 'IsSDBPastDue',
    BIN AS 'BIN',
    FlagOutBranch AS 'FlagOutBranch',
    isTDHoldAmount AS 'isTDHoldAmount',
    isProgramHoldAmount AS 'isProgramHoldAmount',
    IsOfficeHour AS 'IsOfficeHour',
    VALAS AS 'VALAS',
    TransactionLoadTime AS 'TransactionLoadTime',
    DateBirth AS 'DateBirth',
    ChannelTrx AS 'ChannelTrx',
    LastTrxDatetime AS 'LastTrxDatetime',
    LastTrxAmount AS 'LastTrxAmount',
    DrLastTrxDate AS 'DrLastTrxDate',
    DrLastTrxAmount AS 'DrLastTrxAmount',
    CrLastTrxDate AS 'CrLastTrxDate',
    CrLastTrxAmount AS 'CrLastTrxAmount',
    TotalTrxAmountL1D AS 'TotalTrxAmountL1D',
    DrTotalTrxAmountL1D AS 'DrTotalTrxAmountL1D',
    CrTotalTrxAmountL1D AS 'CrTotalTrxAmountL1D',
    TotalTrxAmountL7D AS 'TotalTrxAmountL7D',
    DrTotalTrxAmountL7D AS 'DrTotalTrxAmountL7D',
    CrTotalTrxAmountL7D AS 'CrTotalTrxAmountL7D',
    TotalTrxAmountL1M AS 'TotalTrxAmountL1M',
    DrTotalTrxAmountL1M AS 'DrTotalTrxAmountL1M',
    CrTotalTrxAmountL1M AS 'CrTotalTrxAmountL1M',
    AvgTrxAmountL1D AS 'AvgTrxAmountL1D',
    AvgTrxAmountL7D AS 'AvgTrxAmountL7D',
    AvgTrxAmountL1M AS 'AvgTrxAmountL1M',
    TotalTrxAmount15Mi AS 'TotalTrxAmount15Mi',
    HIghRiskCustomer AS 'HIghRiskCustomer',
    ProductName AS 'ProductName',
    PrevAccStatus AS 'PrevAccStatus',
    Remark4TB AS 'Remark4TB',
    HoldAmountTB AS 'HoldAmountTB',
    Remark4DP AS 'Remark4DP',
    HoldAmountDP AS 'HoldAmountDP',
    HashBytes('SHA2_256', SDBAccountNo) AS 'SDBAccountNo',
    AgeofSDBExpiryDateTrxDate AS 'AgeofSDBExpiryDateTrxDate',
    SDBProdCode AS 'SDBProdCode',
    SDBBalance AS 'SDBBalance',
    AccountReActivedDate AS 'AccountReActivedDate',
    CCBrnAccount AS 'CCBrnAccount',
    BrnNameAccount AS 'BrnNameAccount',
    CCBrnCodeCard AS 'CCBrnCodeCard',
    BrnNameCard AS 'BrnNameCard',
    CCBrnReactivedAccDormant AS 'CCBrnReactivedAccDormant',
    BrnNameReactivedAccDormant AS 'BrnNameReactivedAccDormant',
    TrxBranchName AS 'TrxBranchName',
    IsWhiteList AS 'IsWhiteList',
    IsBlacklistAccount AS 'IsBlacklistAccount',
    IsBlacklistCust AS 'IsBlacklistCust',
    DrCr AS 'DrCr',
    MNemonicDesc AS 'MNemonicDesc',
    ProductCodeTo AS 'ProductCodeTo',
    AccessCode AS 'AccessCode',
    SDBBoxNo AS 'SDBBoxNo',
    SDBStatus AS 'SDBStatus',
    SDBLastPaymentDate AS 'SDBLastPaymentDate',
    SDBLastPaymentAmount AS 'SDBLastPaymentAmount',
    FlagTxnDesc AS 'FlagTxnDesc',
    ProductCodeDep AS 'ProductCodeDep',
    IsMerchantBDI AS 'IsMerchantBDI',
    MerchantTelpNo AS 'MerchantTelpNo',
    MerchantAccOpeningDate AS 'MerchantAccOpeningDate',
    MerchantAccName AS 'MerchantAccName',
    CardIssuerName AS 'CardIssuerName',
    NumOfTrxL1D AS 'NumOfTrxL1D',
    NumOfTrxL7D AS 'NumOfTrxL7D',
    IsHighRiskCountry AS 'IsHighRiskCountry',
    IsBlacklistMerchant AS 'IsBlacklistMerchant',
    IsWatchListMerchant AS 'IsWatchListMerchant',
    IsHighRiskMCC AS 'IsHighRiskMCC',
    HashBytes('SHA2_256', CustomerEmail) AS 'CustomerEmail',
    CreditLimit AS 'CreditLimit',
    CashCreditLimit AS 'CashCreditLimit',
    CardProduct AS 'CardProduct',
    HashBytes('SHA2_256', CustomerNo) AS 'CustomerNo',
    CustomerSex AS 'CustomerSex',
    IsBlacklistCardNo AS 'IsBlacklistCardNo',
    IsValidCard AS 'IsValidCard',
    Currency AS 'Currency',
    POSMode AS 'POSMode',
    PINEntryCapability AS 'PINEntryCapability',
    IsCardExpired AS 'IsCardExpired',
    Is3DSecure AS 'Is3DSecure',
    CardBrand AS 'CardBrand',
    IsWhiteListMerchant AS 'IsWhiteListMerchant',
    IsBDIEmail AS 'IsBDIEmail',
    IsWhiteListCardNo AS 'IsWhiteListCardNo',
    IsWhiteListAccountNo AS 'IsWhiteListAccountNo',
    IsWatchListAccountNo AS 'IsWatchListAccountNo',
    IsAccountBDIEmployee AS 'IsAccountBDIEmployee',
    CodAccess AS 'CodAccess',
    TransactionType AS 'TransactionType',
    TotalTrxAmount10Mi AS 'TotalTrxAmount10Mi',
    CustomerType AS 'CustomerType',
    TotalTrxAmountL5min AS 'TotalTrxAmountL5min',
    TotalTrxAmountContactless AS 'TotalTrxAmountContactless',
    BranchCityAccount AS 'BranchCityAccount',
    BranchZipCodeAcct AS 'BranchZipCodeAcct',
    IsWhitelistCardNoOpen AS 'IsWhitelistCardNoOpen',
    DaysOfWhitelistCardNoOpen AS 'DaysOfWhitelistCardNoOpen',
    IsVAAccount AS 'IsVAAccount',
    IsExcludeTeminalId AS 'IsExcludeTeminalId',
    isBDICard AS 'isBDICard',
    IsWatchlistCardNo AS 'IsWatchlistCardNo',
    SourceChannel AS 'SourceChannel',
    IsBlackListTID AS 'IsBlackListTID',
    HashBytes('SHA2_256', CardNumber) AS 'CardNumber',
    IsFirstTrx3DS AS 'IsFirstTrx3DS',
    VCardDataInputCapability AS 'VCardDataInputCapability',
    CustomerNationality AS 'CustomerNationality',
    TotalTrxAmountContactlessPerDay AS 'TotalTrxAmountContactlessPerDay',
    IsTopUp AS 'IsTopUp',
    IsBillPayment AS 'IsBillPayment',
    IsPaymentToVA AS 'IsPaymentToVA',
    TotalTrxAmountTopUp1 AS 'TotalTrxAmountTopUp1',
    TotalTrxAmountTopUp2 AS 'TotalTrxAmountTopUp2',
    TotalTrxAmountVA1 AS 'TotalTrxAmountVA1',
    TotalTrxAmountVA2 AS 'TotalTrxAmountVA2',
    HashBytes('SHA2_256', CustomerEwaletNumber) AS 'CustomerEwaletNumber',
    IsHighRiskCountryThresholdAmt AS 'IsHighRiskCountryThresholdAmt',
    IsHighRiskCurrency AS 'IsHighRiskCurrency',
    IsHighRiskCurrencyThresholdAmt AS 'IsHighRiskCurrencyThresholdAmt',
    IsQRtrx AS 'IsQRtrx',
    IsDCashTrx AS 'IsDCashTrx',
    IsFTTrx AS 'IsFTTrx',
    IsDCashTrx1 AS 'IsDCashTrx1',
    TotalTrxAmountQRIS AS 'TotalTrxAmountQRIS',
    TotalTrxAmountDcash AS 'TotalTrxAmountDcash',
    TotalTrxAmountTrf AS 'TotalTrxAmountTrf',
    CountTrxQRIS AS 'CountTrxQRIS',
    CountTrxTrf AS 'CountTrxTrf',
    TotalTrxAmountTrf2 AS 'TotalTrxAmountTrf2',
    CountTrxQRIS2 AS 'CountTrxQRIS2',
    CountTrxDcash AS 'CountTrxDcash',
    CountTrxTrf2 AS 'CountTrxTrf2',
    CountTrxVA AS 'CountTrxVA',
    CountTrxInqVA AS 'CountTrxInqVA',
    NumOfTrxL15Min AS 'NumOfTrxL15Min',
    TOTALAMOUNTL2H AS 'TOTALAMOUNTL2H',
    IsWhitelistCardNoPrevilage AS 'IsWhitelistCardNoPrevilage',
    IsWhiteListTID AS 'IsWhiteListTID',
    IsWatchListTID AS 'IsWatchListTID',
    TimeDiffCurrPrev AS 'TimeDiffCurrPrev',
    TotalTrxAmount30Mi AS 'TotalTrxAmount30Mi',
    IsBucket1WatchListCardNo AS 'IsBucket1WatchListCardNo',
    IsBucket1BlacklistCardNo AS 'IsBucket1BlacklistCardNo',
    IsBucket1WhiteListCardNo AS 'IsBucket1WhiteListCardNo',
    IsBucket1WatchListMerchant AS 'IsBucket1WatchListMerchant',
    IsBucket1BlacklistMerchant AS 'IsBucket1BlacklistMerchant',
    IsBucket2WhiteListMerchant AS 'IsBucket2WhiteListMerchant',
    IsBucket2WatchListMerchant AS 'IsBucket2WatchListMerchant',
    IsBucket2BlacklistMerchant AS 'IsBucket2BlacklistMerchant',
    CountTrxEOD AS 'CountTrxEOD',
    IsBucket3WhiteListMerchant AS 'IsBucket3WhiteListMerchant',
    IsBucket3WatchListMerchant AS 'IsBucket3WatchListMerchant',
    IsBucket3WhiteListMID AS 'IsBucket3WhiteListMID',
    IsBucket3WatchListMID AS 'IsBucket3WatchListMID',
    IsBucket3BlacklistMID AS 'IsBucket3BlacklistMID',
    IsFacebookBlacklistMerchant AS 'IsFacebookBlacklistMerchant'
INTO [DataExtractionDB].[dbo].[Transaction_Summary_Calculations_Fraud_Hashed]
FROM [BDI-PRD-PDTORDB].[Predator].[dbo].[Transaction_Summary_Calculations_Fraud] WITH (NOLOCK) WHERE Transaction_Datetime <= @ExtractDate